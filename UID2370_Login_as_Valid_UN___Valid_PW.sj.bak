//USEUNIT _begin
//USEUNIT _end
//USEUNIT AmazonCommonFuncs
//USEUNIT CommonFuncs
//USEUNIT CommonVars
//USEUNIT DbConn
//USEUNIT HTMLReporting
//USEUNIT Library
//USEUNIT Properties
//USEUNIT ReportCommonFuncs
//USEUNIT Repository
//USEUNIT SysAdminCommonFuncs
//USEUNIT Unexpected_Window
/************************************************************************************
Test Steps:
===========
Step1 'Login with the following:
      Username : admin
      Password : admin
      Click on the LOGIN (enabled) button  or Enter on the keyboard
Result:'It logs into Avenio(Millisect) application with username "ValidUser"
          Job list page is displayed.
Created By: Janardhana.
***********************************************************************************/
function UID2370() {
    Properties.TC = "UID2370_Login_as_Valid_UN___Valid_PW";
    CommonFuncs.Begin_test();
    AmazonCommonFuncs.CloseApplicaton(Properties.APP_NAME);
    AmazonCommonFuncs.LoadApplication(Properties.APP_NAME)

    //Step1 'Login with the following:
    //Username : admin Password : admin
    //Click on the LOGIN (enabled) button  or Enter on the keyboard
    //Result:'It logs into Avenio(Millisect) application with username "ValidUser"
    //Job list page is displayed. 
    var objLogin = AmazonCommonFuncs.login(Properties.ADMIN_ID, Properties.ADMIN_PASSWORD);
    var objValidUser = verifyUser();
    if (objLogin && objValidUser) {
        ReportCommonFuncs.Report_a_verify(1, "Pass", "N");
    } else {
        ReportCommonFuncs.Report_a_verify(1, "Fail", "Y");
    }

    CommonFuncs.Verify_final_result(_final_result);
    CommonFuncs.Finish_test();


    function verifyUser() {
        try {
            var Page = CommonVars.page;
            PropArray = new Array("ClrClassName", "Name");
            ValuesArray = new Array("TextBlock", "WPFObject(\"userNameText\")");
            var objUserVerfiy = Page.Find(PropArray, ValuesArray, _depth);
            if (objUserVerfiy.WPFControlText == Properties.ADMIN_ID) {
                return true;
            } else {
                return false;
            }
        } catch (e) {
            Log.Message("verifyUser() Error" + e.description);
        }
    }
}